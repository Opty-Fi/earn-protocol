# OptyFi CLI

Run `yarn hardhat` to check all available tasks.

Follow the below command to run a specific task :

```
yarn hardhat `name` --network `network` --flagName `flagValue`
```

## Deployment Tasks

To deploy OptyFi's contracts.

| Name                         | Prerequisite Contracts                                  | Flags                                                                       | Optional Flags           | Description                                                | Example                                                                                                                                                                                                                                                                                                                                                     |
| ---------------------------- | ------------------------------------------------------- | --------------------------------------------------------------------------- | ------------------------ | ---------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| deploy-adapter               | Registry, HarvestCodeProvider, Priceoracle              | registry, harvestcodeprovider, priceoracle, name                            | deployedonce, insertindb | deploy specific adapter contract                           | yarn hardhat deploy-adapter --network localhost --registry 0x0000000000000000000000000000000000000000 --harvestcodeprovider 0x0000000000000000000000000000000000000000 --priceoracle 0x0000000000000000000000000000000000000000 --name AaveV1Adapter                                                                                                        |
| deploy-adapters              | Registry, HarvestCodeProvider, Priceoracle              | registry, harvestcodeprovider, priceoracle                                  | deployedonce, insertindb | deploy all available adapter contracts                     | yarn hardhat deploy-adapters --network localhost --registry 0x0000000000000000000000000000000000000000 --harvestcodeprovider 0x0000000000000000000000000000000000000000 --priceoracle 0x0000000000000000000000000000000000000000                                                                                                                            |
| deploy-harvest-code-provider | Registry                                                | registry                                                                    | deployedonce, insertindb | deploy HarvestCodeProvider contract                        | yarn hardhat deploy-harvest-code-provider --network localhost --registry 0x0000000000000000000000000000000000000000                                                                                                                                                                                                                                         |
| deploy-opty                  | Registry                                                | registry                                                                    | deployedonce, insertindb | deploy OPTY and OPTYDistributor contracts                  | yarn hardhat deploy-opty --network localhost --registry 0x0000000000000000000000000000000000000000                                                                                                                                                                                                                                                          |
| deploy-registry              | N/A                                                     | N/A                                                                         | deployedonce, insertindb | deploy Registry contract                                   | yarn hardhat deploy-registry --network localhost                                                                                                                                                                                                                                                                                                            |
| deploy-vault-step-registry   | Registry                                                | registry                                                                    | deployedonce, insertindb | deploy VaultStepInvestStrategyDefinitionRegistry contracts | yarn hardhat deploy-vault-step-registry --network localhost --registry 0x0000000000000000000000000000000000000000                                                                                                                                                                                                                                           |
| deploy-risk-manager          | Registry                                                | registry                                                                    | deployedonce, insertindb | deploy RiskManager contract                                | yarn hardhat deploy-risk-manager --network localhost --registry 0x0000000000000000000000000000000000000000                                                                                                                                                                                                                                                  |
| deploy-strategy-manager      | Registry, HarvestCodeProvider                           | registry, harvestcodeprovider                                               | deployedonce, insertindb | deploy StrategyManager contract                            | yarn hardhat deploy-strategy-manager --network localhost --registry 0x0000000000000000000000000000000000000000 --harvestcodeprovider 0x0000000000000000000000000000000000000000                                                                                                                                                                             |
| deploy-strategy-provider     | Registry                                                | registry                                                                    | deployedonce, insertindb | deploy StrategyProvider contract                           | yarn hardhat deploy-strategy-provider --network localhost --registry 0x0000000000000000000000000000000000000000                                                                                                                                                                                                                                             |
| deploy-vault                 | Registry, RiskManager, StrategyManager, OPTYDistributor | token, riskprofile, registry, riskmanager, strategymanager, optydistributor | insertindb               | deploy specific vault contract                             | yarn hardhat deploy-vault --network localhost --registry 0x0000000000000000000000000000000000000000 --riskmanager 0x0000000000000000000000000000000000000000 --strategymanager 0x0000000000000000000000000000000000000000 --optydistributor 0x0000000000000000000000000000000000000000 --token 0x0000000000000000000000000000000000000000 --riskprofile RP1 |
| deploy-vaults                | Registry, RiskManager, StrategyManager, OPTYDistributor | registry, riskmanager, strategymanager, optydistributor                     | insertindb               | deploy all designated vault contracts                      | yarn hardhat deploy-vaults --network localhost --registry 0x0000000000000000000000000000000000000000 --riskmanager 0x0000000000000000000000000000000000000000 --strategymanager 0x0000000000000000000000000000000000000000 --optydistributor 0x0000000000000000000000000000000000000000                                                                     |
| deploy-erc20                 | N/A                                                     | name, symbol, total, decimal                                                | deployonce, insertindb   | deploy erc20 contract                                      | yarn hardhat deploy-erc20 --network localhost --name ERC20 symbol ERC20 --total 0 --decimal 18                                                                                                                                                                                                                                                              |

## Action Tasks

To execute functions in a OptyFi's contract.

| Name                    | Prerequisite Contracts                              | Flags                                                                                        | Optional Flags | Description                                                                | Example                                                                                                                                                                                                                                                          |
| ----------------------- | --------------------------------------------------- | -------------------------------------------------------------------------------------------- | -------------- | -------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| set-strategies          | VaultStepInvestStrategyDefinitionRegistry           | strategyregistry, fromfile                                                                   | N/A            | set all current available strategies with file or default                  | yarn hardhat set-strategies --network localhost --strategyregistry 0x0000000000000000000000000000000000000000 --fromfile /home/file.json                                                                                                                         |
| approve-tokens          | Registry                                            | registry                                                                                     | N/A            | approve all available tokens                                               | yarn hardhat approve-tokens --network localhost --registry 0x0000000000000000000000000000000000000000                                                                                                                                                            |
| approve-token           | Registry                                            | registry, token                                                                              | N/A            | approve a specific tokens                                                  | yarn hardhat approve-token --network localhost --registry 0x0000000000000000000000000000000000000000 --token 0x0000000000000000000000000000000000000000                                                                                                          |
| get-all-strategies      | VaultStepInvestStrategyDefinitionRegistry           | strategyregistry, token                                                                      | N/A            | get all strategies for a specific tokens                                   | yarn hardhat get-all-strategies --network localhost --strategyregistry 0x0000000000000000000000000000000000000000 --token 0x0000000000000000000000000000000000000000                                                                                             |
| get-best-strategy       | StrategyProvider                                    | token, riskprofile, strategyprovider, isdefault                                              | N/A            | get best strategy or default best strategy for the token with risk profile | yarn hardhat get-best-strategy --network localhost --riskprofile RP1 --strategyprovider 0x0000000000000000000000000000000000000000 --token 0x0000000000000000000000000000000000000000 --isdefault true                                                           |
| set-best-strategy       | StrategyProvider                                    | token, riskprofile, strategyhash, strategyprovider, isdefault                                | N/A            | set best strategy or default best strategy                                 | yarn hardhat set-best-strategy --network localhost --riskprofile RP1 --strategyhash 0x0000000000000000000000000000000000000000 --strategyprovider 0x0000000000000000000000000000000000000000 --token 0x0000000000000000000000000000000000000000 --isdefault true |
| set-vault-step-registry | Registry, VaultStepInvestStrategyDefinitionRegistry | registry, strategyregistry                                                                   | N/A            | set vault step registry in registry contract                               | yarn hardhat set-vault-step-registry --network localhost --registry 0x0000000000000000000000000000000000000000 --strategyregistry 0x0000000000000000000000000000000000000000                                                                                     |
| unpause-vault           | Registry, Vault                                     | registry, vault                                                                              | N/A            | unpause the vault                                                          | yarn hardhat unpause-vault --network localhost --registry 0x0000000000000000000000000000000000000000 --vault 0x0000000000000000000000000000000000000000                                                                                                          |
| vault-actions           | Vault                                               | vault, action(deposit/withdraw/rebalance), withrebalance (boolean), useall (boolean), amount | N/A            | perform actions in the vault contract                                      | yarn hardhat vault-actions --network localhost --vault 0x0000000000000000000000000000000000000000 --action deposit --withrebalance true --useall false --amount 500000                                                                                           |
